FROM python:3.9-slim-buster

MAINTAINER Flyte Team <users@flyte.org>
LABEL org.opencontainers.image.source=https://github.com/flyteorg/flytekit

# ARG VERSION
# RUN pip install -U flytekit==$VERSION flytekitplugins-bigquery==$VERSION
RUN apt-get update && apt-get install -y git gcc

# RUN pip install --upgrade pip setuptools wheel psutil
RUN pip install apache-airflow
RUN pip install msgpack
RUN pip install google-cloud-orchestration-airflow==1.9.1
RUN pip install apache-airflow-providers-google
RUN pip install jsonpickle
# RUN pip install apache-airflow-providers-apache-hive

RUN pip install git+https://github.com/flyteorg/flytekit.git@38d4b2b35d2ffd89142779ea204892dc08a55130#subdirectory=plugins/flytekit-airflow
RUN pip install git+https://github.com/flyteorg/flytekit.git@38d4b2b35d2ffd89142779ea204892dc08a55130

CMD pyflyte serve --port 8000
